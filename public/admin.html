<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel | Ada Bubbles</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üëë</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #d4af37;
            --gold-light: #f4e4bc;
            --gold-dark: #b8960c;
            --rose: #e91e63;
            --rose-dark: #c2185b;
            --black: #0a0a0a;
            --black-light: #1a1a1a;
            --black-card: #141414;
            --white: #fafafa;
            --gray: #888;
            --green: #4ade80;
            --red: #ef4444;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background: var(--black);
            color: var(--white);
            min-height: 100vh;
        }
        
        /* ============================================
           LOGIN SCREEN
           ============================================ */
        #loginScreen {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: 
                radial-gradient(ellipse at top, rgba(212, 175, 55, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at bottom, rgba(233, 30, 99, 0.05) 0%, transparent 50%);
        }
        
        #loginScreen.hidden {
            display: none;
        }
        
        .login-box {
            background: var(--black-card);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 12px;
            padding: 3rem;
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        
        .login-logo {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            background: linear-gradient(135deg, var(--gold-light), var(--gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }
        
        .login-subtitle {
            color: var(--gray);
            font-size: 0.85rem;
            margin-bottom: 2rem;
        }
        
        .form-group {
            margin-bottom: 1.25rem;
            text-align: left;
        }
        
        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--gray);
            font-size: 0.85rem;
        }
        
        .form-input {
            width: 100%;
            padding: 0.875rem 1rem;
            background: var(--black);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 8px;
            color: var(--white);
            font-family: 'Montserrat', sans-serif;
            font-size: 0.95rem;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            border-color: var(--gold);
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1);
        }
        
        .login-btn {
            width: 100%;
            padding: 1rem;
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            border: none;
            border-radius: 8px;
            color: var(--black);
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .login-btn:hover {
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.4);
            transform: translateY(-2px);
        }
        
        .login-error {
            color: var(--red);
            font-size: 0.85rem;
            margin-top: 1rem;
            display: none;
        }
        
        .login-error.show {
            display: block;
        }
        
        /* ============================================
           ADMIN PANEL
           ============================================ */
        #adminPanel {
            display: none;
        }
        
        #adminPanel.visible {
            display: block;
        }
        
        /* Sidebar */
        .admin-layout {
            display: flex;
            min-height: 100vh;
        }
        
        .sidebar {
            width: 260px;
            background: var(--black-card);
            border-right: 1px solid rgba(212, 175, 55, 0.2);
            padding: 1.5rem;
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
            overflow-y: auto;
        }
        
        .sidebar-logo {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            background: linear-gradient(135deg, var(--gold-light), var(--gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.25rem;
        }
        
        .sidebar-badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            background: linear-gradient(135deg, var(--rose), var(--rose-dark));
            border-radius: 4px;
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 2rem;
        }
        
        .sidebar-nav {
            list-style: none;
        }
        
        .nav-item {
            margin-bottom: 0.5rem;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.875rem 1rem;
            color: var(--gray);
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .nav-link:hover {
            background: rgba(212, 175, 55, 0.1);
            color: var(--gold);
        }
        
        .nav-link.active {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.2), rgba(212, 175, 55, 0.1));
            color: var(--gold);
            border: 1px solid rgba(212, 175, 55, 0.3);
        }
        
        .nav-icon {
            font-size: 1.1rem;
        }
        
        .nav-badge {
            margin-left: auto;
            background: var(--rose);
            color: white;
            font-size: 0.7rem;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            font-weight: 600;
        }
        
        .sidebar-footer {
            position: absolute;
            bottom: 1.5rem;
            left: 1.5rem;
            right: 1.5rem;
        }
        
        .logout-btn {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem;
            background: transparent;
            border: 1px solid var(--red);
            border-radius: 8px;
            color: var(--red);
            font-family: 'Montserrat', sans-serif;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .logout-btn:hover {
            background: var(--red);
            color: white;
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 260px;
            padding: 2rem;
        }
        
        .page-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(212, 175, 55, 0.1);
        }
        
        .page-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.75rem;
            color: var(--white);
        }
        
        .page-subtitle {
            color: var(--gray);
            font-size: 0.85rem;
            margin-top: 0.25rem;
        }
        
        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: var(--black-card);
            border: 1px solid rgba(212, 175, 55, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            border-color: rgba(212, 175, 55, 0.3);
            transform: translateY(-2px);
        }
        
        .stat-icon {
            font-size: 2rem;
            margin-bottom: 0.75rem;
        }
        
        .stat-value {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            font-weight: 700;
            color: var(--gold);
        }
        
        .stat-label {
            color: var(--gray);
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }
        
        /* Data Tables */
        .data-section {
            background: var(--black-card);
            border: 1px solid rgba(212, 175, 55, 0.1);
            border-radius: 12px;
            margin-bottom: 2rem;
            overflow: hidden;
        }
        
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid rgba(212, 175, 55, 0.1);
        }
        
        .section-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.1rem;
            color: var(--white);
        }
        
        .section-actions {
            display: flex;
            gap: 0.75rem;
        }
        
        .btn-small {
            padding: 0.5rem 1rem;
            background: transparent;
            border: 1px solid var(--gold);
            border-radius: 6px;
            color: var(--gold);
            font-family: 'Montserrat', sans-serif;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-small:hover {
            background: var(--gold);
            color: var(--black);
        }
        
        .btn-small.primary {
            background: var(--gold);
            color: var(--black);
        }
        
        .btn-small.primary:hover {
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.4);
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .data-table th,
        .data-table td {
            padding: 1rem 1.5rem;
            text-align: left;
            border-bottom: 1px solid rgba(212, 175, 55, 0.05);
        }
        
        .data-table th {
            color: var(--gray);
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }
        
        .data-table tr:hover {
            background: rgba(212, 175, 55, 0.03);
        }
        
        .user-cell {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--gold), var(--rose));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--black);
        }
        
        .user-name {
            font-weight: 500;
        }
        
        .user-email {
            color: var(--gray);
            font-size: 0.8rem;
        }
        
        .badge {
            display: inline-block;
            padding: 0.3rem 0.6rem;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
        }
        
        .badge-active {
            background: rgba(74, 222, 128, 0.2);
            color: var(--green);
        }
        
        .badge-pending {
            background: rgba(212, 175, 55, 0.2);
            color: var(--gold);
        }
        
        .action-btn {
            background: none;
            border: none;
            padding: 0.5rem;
            cursor: pointer;
            font-size: 1rem;
            opacity: 0.6;
            transition: all 0.3s ease;
        }
        
        .action-btn:hover {
            opacity: 1;
        }
        
        .action-btn.delete:hover {
            color: var(--red);
        }
        
        /* Content Section */
        .content-page {
            display: none;
        }
        
        .content-page.active {
            display: block;
        }
        
        /* Add Content Form */
        .content-form {
            background: var(--black-card);
            border: 1px solid rgba(212, 175, 55, 0.1);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .form-group textarea {
            width: 100%;
            min-height: 150px;
            padding: 1rem;
            background: var(--black);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 8px;
            color: var(--white);
            font-family: 'Montserrat', sans-serif;
            font-size: 0.95rem;
            resize: vertical;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .form-group textarea:focus {
            border-color: var(--gold);
        }
        
        .form-group select {
            width: 100%;
            padding: 0.875rem 1rem;
            background: var(--black);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 8px;
            color: var(--white);
            font-family: 'Montserrat', sans-serif;
            font-size: 0.95rem;
            outline: none;
            cursor: pointer;
        }
        
        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }
        
        .btn-primary {
            padding: 0.875rem 2rem;
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            border: none;
            border-radius: 8px;
            color: var(--black);
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.4);
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            padding: 0.875rem 2rem;
            background: transparent;
            border: 1px solid var(--gray);
            border-radius: 8px;
            color: var(--gray);
            font-family: 'Montserrat', sans-serif;
            font-weight: 500;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            border-color: var(--white);
            color: var(--white);
        }
        
        /* Posts Grid */
        .posts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            padding: 1.5rem;
        }
        
        .post-card {
            background: var(--black);
            border: 1px solid rgba(212, 175, 55, 0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .post-image {
            height: 150px;
            background: linear-gradient(135deg, rgba(233, 30, 99, 0.2), rgba(212, 175, 55, 0.2));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
        }
        
        .post-content {
            padding: 1rem;
        }
        
        .post-title {
            font-family: 'Playfair Display', serif;
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }
        
        .post-meta {
            display: flex;
            align-items: center;
            justify-content: space-between;
            color: var(--gray);
            font-size: 0.75rem;
        }
        
        .post-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        /* Messages Page */
        .message-item {
            display: flex;
            gap: 1rem;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid rgba(212, 175, 55, 0.05);
            transition: background 0.3s ease;
        }
        
        .message-item:hover {
            background: rgba(212, 175, 55, 0.03);
        }
        
        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--gold), var(--rose));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--black);
            flex-shrink: 0;
        }
        
        .message-content {
            flex: 1;
        }
        
        .message-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.25rem;
        }
        
        .message-from {
            font-weight: 600;
            color: var(--gold);
        }
        
        .message-time {
            color: var(--gray);
            font-size: 0.75rem;
        }
        
        .message-text {
            color: var(--white);
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        .message-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--gray);
        }
        
        .empty-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }
        
        .empty-text {
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }
        
        .empty-hint {
            font-size: 0.85rem;
            opacity: 0.7;
        }
        
        /* Toast */
        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--black-card);
            border: 1px solid var(--gold);
            border-radius: 8px;
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            z-index: 1000;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .toast.success {
            border-color: var(--green);
        }
        
        .toast.error {
            border-color: var(--red);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    
    <!-- ==========================================
         LOGIN SCREEN
         ========================================== -->
    <div id="loginScreen">
        <div class="login-box">
            <div class="login-logo">Ada Bubbles</div>
            <div class="login-subtitle">Admin Panel</div>
            
            <form id="loginForm" onsubmit="handleAdminLogin(event)">
                <div class="form-group">
                    <label class="form-label">Username</label>
                    <input type="text" class="form-input" id="adminUsername" placeholder="admin" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-input" id="adminPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                </div>
                <button type="submit" class="login-btn">Sign In</button>
                <div class="login-error" id="loginError">Invalid credentials</div>
            </form>
        </div>
    </div>
    
    <!-- ==========================================
         ADMIN PANEL
         ========================================== -->
    <div id="adminPanel">
        <div class="admin-layout">
            
            <!-- Sidebar -->
            <aside class="sidebar">
                <div class="sidebar-logo">Ada Bubbles</div>
                <span class="sidebar-badge">Admin</span>
                
                <ul class="sidebar-nav">
                    <li class="nav-item">
                        <a class="nav-link active" onclick="switchPage('dashboard')">
                            <span class="nav-icon">üìä</span>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="switchPage('users')">
                            <span class="nav-icon">üë•</span>
                            <span>Users</span>
                            <span class="nav-badge" id="usersCount">0</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="switchPage('messages')">
                            <span class="nav-icon">üí¨</span>
                            <span>Messages</span>
                            <span class="nav-badge" id="messagesCount">0</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="switchPage('content')">
                            <span class="nav-icon">üìù</span>
                            <span>Content</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="switchPage('settings')">
                            <span class="nav-icon">‚öôÔ∏è</span>
                            <span>Settings</span>
                        </a>
                    </li>
                </ul>
                
                <div class="sidebar-footer">
                    <a href="/" class="btn-small" style="width: 100%; text-align: center; display: block; margin-bottom: 0.75rem; text-decoration: none;">‚Üê Back to Site</a>
                    <button class="logout-btn" onclick="handleLogout()">
                        <span>üö™</span>
                        <span>Log Out</span>
                    </button>
                </div>
            </aside>
            
            <!-- Main Content -->
            <main class="main-content">
                
                <!-- Dashboard Page -->
                <div class="content-page active" id="page-dashboard">
                    <div class="page-header">
                        <div>
                            <h1 class="page-title">Dashboard</h1>
                            <p class="page-subtitle">Welcome back, Admin</p>
                        </div>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">üë•</div>
                            <div class="stat-value" id="statUsers">0</div>
                            <div class="stat-label">Total Users</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üí¨</div>
                            <div class="stat-value" id="statMessages">0</div>
                            <div class="stat-label">Messages</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üìù</div>
                            <div class="stat-value" id="statPosts">0</div>
                            <div class="stat-label">Posts</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üíé</div>
                            <div class="stat-value" id="statCoins">0</div>
                            <div class="stat-label">Total Coins Sold</div>
                        </div>
                    </div>
                    
                    <!-- Recent Activity -->
                    <div class="data-section">
                        <div class="section-header">
                            <h3 class="section-title">Recent Activity</h3>
                        </div>
                        <div id="recentActivity">
                            <div class="empty-state">
                                <div class="empty-icon">üìä</div>
                                <div class="empty-text">No recent activity</div>
                                <div class="empty-hint">Activity will appear here</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Users Page -->
                <div class="content-page" id="page-users">
                    <div class="page-header">
                        <div>
                            <h1 class="page-title">Users</h1>
                            <p class="page-subtitle">Manage registered users</p>
                        </div>
                        <div class="section-actions">
                            <button class="btn-small" onclick="loadUsers()">üîÑ Refresh</button>
                        </div>
                    </div>
                    
                    <div class="data-section">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>User</th>
                                    <th>Registered</th>
                                    <th>Coins</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="usersTable">
                                <!-- Users will be loaded here -->
                            </tbody>
                        </table>
                        <div id="usersEmpty" class="empty-state" style="display: none;">
                            <div class="empty-icon">üë•</div>
                            <div class="empty-text">No users yet</div>
                            <div class="empty-hint">Users will appear when they register</div>
                        </div>
                    </div>
                </div>
                
                <!-- Messages Page -->
                <div class="content-page" id="page-messages">
                    <div class="page-header">
                        <div>
                            <h1 class="page-title">Messages</h1>
                            <p class="page-subtitle">View user messages</p>
                        </div>
                        <div class="section-actions">
                            <button class="btn-small" onclick="loadMessages()">üîÑ Refresh</button>
                            <button class="btn-small" onclick="clearAllMessages()" style="border-color: var(--red); color: var(--red);">üóë Clear All</button>
                        </div>
                    </div>
                    
                    <div class="data-section">
                        <div id="messagesList">
                            <!-- Messages will be loaded here -->
                        </div>
                        <div id="messagesEmpty" class="empty-state" style="display: none;">
                            <div class="empty-icon">üí¨</div>
                            <div class="empty-text">No messages yet</div>
                            <div class="empty-hint">Messages from users will appear here</div>
                        </div>
                    </div>
                </div>
                
                <!-- Content Page -->
                <div class="content-page" id="page-content">
                    <div class="page-header">
                        <div>
                            <h1 class="page-title">Content</h1>
                            <p class="page-subtitle">Manage posts and content</p>
                        </div>
                    </div>
                    
                    <!-- Add New Post Form -->
                    <div class="content-form">
                        <h3 style="font-family: 'Playfair Display', serif; margin-bottom: 1.5rem; color: var(--gold);">Add New Post</h3>
                        <form id="addPostForm" onsubmit="handleAddPost(event)">
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Title</label>
                                    <input type="text" class="form-input" id="postTitle" placeholder="Post title" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Type</label>
                                    <select class="form-input" id="postType">
                                        <option value="free">Free</option>
                                        <option value="premium">Premium (50 coins)</option>
                                        <option value="exclusive">Exclusive (100 coins)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Description</label>
                                <textarea id="postDescription" placeholder="Post description..."></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Image URL (optional)</label>
                                <input type="text" class="form-input" id="postImage" placeholder="https://...">
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn-secondary" onclick="clearPostForm()">Cancel</button>
                                <button type="submit" class="btn-primary">Add Post</button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Posts Grid -->
                    <div class="data-section">
                        <div class="section-header">
                            <h3 class="section-title">All Posts</h3>
                            <button class="btn-small" onclick="loadPosts()">üîÑ Refresh</button>
                        </div>
                        <div class="posts-grid" id="postsGrid">
                            <!-- Posts will be loaded here -->
                        </div>
                        <div id="postsEmpty" class="empty-state" style="display: none;">
                            <div class="empty-icon">üìù</div>
                            <div class="empty-text">No posts yet</div>
                            <div class="empty-hint">Add your first post above</div>
                        </div>
                    </div>
                </div>
                
                <!-- Settings Page -->
                <div class="content-page" id="page-settings">
                    <div class="page-header">
                        <div>
                            <h1 class="page-title">Settings</h1>
                            <p class="page-subtitle">Configure admin panel</p>
                        </div>
                    </div>
                    
                    <div class="content-form">
                        <h3 style="font-family: 'Playfair Display', serif; margin-bottom: 1.5rem; color: var(--gold);">Change Admin Password</h3>
                        <form onsubmit="handleChangePassword(event)">
                            <div class="form-group">
                                <label class="form-label">Current Password</label>
                                <input type="password" class="form-input" id="currentPassword" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">New Password</label>
                                <input type="password" class="form-input" id="newPassword" required minlength="6">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Confirm New Password</label>
                                <input type="password" class="form-input" id="confirmPassword" required>
                            </div>
                            <div class="form-actions">
                                <button type="submit" class="btn-primary">Update Password</button>
                            </div>
                        </form>
                    </div>
                    
                    <div class="content-form" style="border-color: var(--red);">
                        <h3 style="font-family: 'Playfair Display', serif; margin-bottom: 1rem; color: var(--red);">Danger Zone</h3>
                        <p style="color: var(--gray); margin-bottom: 1.5rem; font-size: 0.9rem;">These actions are irreversible. Be careful!</p>
                        <div class="form-actions" style="justify-content: flex-start;">
                            <button class="btn-secondary" style="border-color: var(--red); color: var(--red);" onclick="resetAllData()">üóë Reset All Data</button>
                        </div>
                    </div>
                </div>
                
            </main>
        </div>
    </div>
    
    <!-- Toast -->
    <div class="toast" id="toast">
        <span id="toastIcon">‚úÖ</span>
        <span id="toastMessage">Success!</span>
    </div>
    
    <script>
        // ============================================
        // –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø
        // ============================================
        const API_BASE = '/api/admin';
        
        // –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫—Ä–µ–¥—ã –∞–¥–º–∏–Ω–∞ (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ - –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!)
        const DEFAULT_ADMIN = {
            username: 'ada',
            password: 'bubbles2025'
        };
        
        // ============================================
        // –°–û–°–¢–û–Ø–ù–ò–ï
        // ============================================
        let adminState = {
            isLoggedIn: false,
            token: localStorage.getItem('adminToken') || null,
            users: [],
            messages: [],
            posts: []
        };
        
        // ============================================
        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        // ============================================
        document.addEventListener('DOMContentLoaded', () => {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–ª–æ–≥–∏–Ω–µ–Ω –ª–∏ –∞–¥–º–∏–Ω
            if (adminState.token) {
                verifyToken();
            }
        });
        
        async function verifyToken() {
            try {
                const response = await fetch(`${API_BASE}/verify`, {
                    headers: { 'Authorization': `Bearer ${adminState.token}` }
                });
                
                if (response.ok) {
                    showAdminPanel();
                } else {
                    localStorage.removeItem('adminToken');
                }
            } catch (error) {
                // –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —Ä–∞–±–æ—Ç–∞–µ–º –ª–æ–∫–∞–ª—å–Ω–æ
                console.log('Server not available, using local mode');
                if (adminState.token === 'local-admin-token') {
                    showAdminPanel();
                }
            }
        }
        
        // ============================================
        // –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø
        // ============================================
        async function handleAdminLogin(e) {
            e.preventDefault();
            
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;
            
            try {
                const response = await fetch(`${API_BASE}/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });
                
                const data = await response.json();
                
                if (data.ok && data.token) {
                    adminState.token = data.token;
                    localStorage.setItem('adminToken', data.token);
                    showAdminPanel();
                } else {
                    showLoginError(data.error || 'Invalid credentials');
                }
            } catch (error) {
                // –õ–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
                if (username === DEFAULT_ADMIN.username && password === DEFAULT_ADMIN.password) {
                    adminState.token = 'local-admin-token';
                    localStorage.setItem('adminToken', adminState.token);
                    showAdminPanel();
                } else {
                    showLoginError('Invalid credentials');
                }
            }
        }
        
        function showLoginError(message) {
            const errorEl = document.getElementById('loginError');
            errorEl.textContent = message;
            errorEl.classList.add('show');
            setTimeout(() => errorEl.classList.remove('show'), 3000);
        }
        
        function showAdminPanel() {
            adminState.isLoggedIn = true;
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('adminPanel').classList.add('visible');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            loadDashboard();
        }
        
        function handleLogout() {
            adminState.isLoggedIn = false;
            adminState.token = null;
            localStorage.removeItem('adminToken');
            
            document.getElementById('adminPanel').classList.remove('visible');
            document.getElementById('loginScreen').classList.remove('hidden');
            
            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('adminUsername').value = '';
            document.getElementById('adminPassword').value = '';
        }
        
        // ============================================
        // –ù–ê–í–ò–ì–ê–¶–ò–Ø
        // ============================================
        function switchPage(page) {
            // –£–±–∏—Ä–∞–µ–º active —É –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –∏ —Å—Å—ã–ª–æ–∫
            document.querySelectorAll('.content-page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
            document.getElementById(`page-${page}`).classList.add('active');
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —Å—Å—ã–ª–∫—É
            event.target.closest('.nav-link').classList.add('active');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            switch(page) {
                case 'dashboard': loadDashboard(); break;
                case 'users': loadUsers(); break;
                case 'messages': loadMessages(); break;
                case 'content': loadPosts(); break;
            }
        }
        
        // ============================================
        // DASHBOARD
        // ============================================
        async function loadDashboard() {
            try {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                const response = await fetch(`${API_BASE}/stats`, {
                    headers: { 'Authorization': `Bearer ${adminState.token}` }
                });
                
                if (response.ok) {
                    const stats = await response.json();
                    updateDashboardStats(stats);
                }
            } catch (error) {
                // –õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                updateDashboardStats({
                    users: adminState.users.length,
                    messages: adminState.messages.length,
                    posts: adminState.posts.length,
                    coins: 0
                });
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
            await loadUsers();
            await loadMessages();
            await loadPosts();
        }
        
        function updateDashboardStats(stats) {
            document.getElementById('statUsers').textContent = stats.users || 0;
            document.getElementById('statMessages').textContent = stats.messages || 0;
            document.getElementById('statPosts').textContent = stats.posts || 0;
            document.getElementById('statCoins').textContent = stats.coins || 0;
            
            document.getElementById('usersCount').textContent = stats.users || 0;
            document.getElementById('messagesCount').textContent = stats.messages || 0;
        }
        
        // ============================================
        // USERS
        // ============================================
        async function loadUsers() {
            try {
                const response = await fetch(`${API_BASE}/users`, {
                    headers: { 'Authorization': `Bearer ${adminState.token}` }
                });
                
                if (response.ok) {
                    adminState.users = await response.json();
                }
            } catch (error) {
                console.log('Loading local users');
            }
            
            renderUsers();
        }
        
        function renderUsers() {
            const table = document.getElementById('usersTable');
            const empty = document.getElementById('usersEmpty');
            
            if (adminState.users.length === 0) {
                table.innerHTML = '';
                empty.style.display = 'block';
                return;
            }
            
            empty.style.display = 'none';
            table.innerHTML = adminState.users.map(user => `
                <tr>
                    <td>
                        <div class="user-cell">
                            <div class="user-avatar">${(user.name || user.username || 'U')[0].toUpperCase()}</div>
                            <div>
                                <div class="user-name">${user.name || user.username}</div>
                                <div class="user-email">${user.email || '‚Äî'}</div>
                            </div>
                        </div>
                    </td>
                    <td>${formatDate(user.createdAt)}</td>
                    <td>${user.coins || 0} üíé</td>
                    <td><span class="badge badge-active">Active</span></td>
                    <td>
                        <button class="action-btn" title="View">üëÅ</button>
                        <button class="action-btn delete" title="Delete" onclick="deleteUser('${user.id || user.username}')">üóë</button>
                    </td>
                </tr>
            `).join('');
            
            document.getElementById('usersCount').textContent = adminState.users.length;
            document.getElementById('statUsers').textContent = adminState.users.length;
        }
        
        async function deleteUser(userId) {
            if (!confirm('Are you sure you want to delete this user?')) return;
            
            try {
                const response = await fetch(`${API_BASE}/users/${userId}`, {
                    method: 'DELETE',
                    headers: { 'Authorization': `Bearer ${adminState.token}` }
                });
                
                if (response.ok) {
                    showToast('User deleted', '‚úÖ');
                    loadUsers();
                }
            } catch (error) {
                adminState.users = adminState.users.filter(u => (u.id || u.username) !== userId);
                renderUsers();
                showToast('User deleted', '‚úÖ');
            }
        }
        
        // ============================================
        // MESSAGES
        // ============================================
        async function loadMessages() {
            try {
                const response = await fetch(`${API_BASE}/messages`, {
                    headers: { 'Authorization': `Bearer ${adminState.token}` }
                });
                
                if (response.ok) {
                    adminState.messages = await response.json();
                }
            } catch (error) {
                // –ü—Ä–æ–±—É–µ–º –æ–±—ã—á–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç
                try {
                    const response = await fetch('/api/messages');
                    if (response.ok) {
                        adminState.messages = await response.json();
                    }
                } catch (e) {
                    console.log('Loading local messages');
                }
            }
            
            renderMessages();
        }
        
        function renderMessages() {
            const list = document.getElementById('messagesList');
            const empty = document.getElementById('messagesEmpty');
            
            if (adminState.messages.length === 0) {
                list.innerHTML = '';
                empty.style.display = 'block';
                return;
            }
            
            empty.style.display = 'none';
            list.innerHTML = adminState.messages.map((msg, index) => `
                <div class="message-item">
                    <div class="message-avatar">${(msg.from || 'U')[0].toUpperCase()}</div>
                    <div class="message-content">
                        <div class="message-header">
                            <span class="message-from">${msg.from || 'Unknown'}</span>
                            <span class="message-time">${formatDate(msg.timestamp)}</span>
                        </div>
                        <div class="message-text">${escapeHtml(msg.text)}</div>
                    </div>
                    <div class="message-actions">
                        <button class="action-btn delete" title="Delete" onclick="deleteMessage(${index})">üóë</button>
                    </div>
                </div>
            `).join('');
            
            document.getElementById('messagesCount').textContent = adminState.messages.length;
            document.getElementById('statMessages').textContent = adminState.messages.length;
        }
        
        async function deleteMessage(index) {
            try {
                const response = await fetch(`${API_BASE}/messages/${index}`, {
                    method: 'DELETE',
                    headers: { 'Authorization': `Bearer ${adminState.token}` }
                });
                
                if (response.ok) {
                    showToast('Message deleted', '‚úÖ');
                    loadMessages();
                }
            } catch (error) {
                adminState.messages.splice(index, 1);
                renderMessages();
                showToast('Message deleted', '‚úÖ');
            }
        }
        
        async function clearAllMessages() {
            if (!confirm('Are you sure you want to delete ALL messages?')) return;
            
            try {
                await fetch(`${API_BASE}/messages`, {
                    method: 'DELETE',
                    headers: { 'Authorization': `Bearer ${adminState.token}` }
                });
            } catch (error) {
                adminState.messages = [];
            }
            
            renderMessages();
            showToast('All messages cleared', '‚úÖ');
        }
        
        // ============================================
        // CONTENT / POSTS
        // ============================================
        async function loadPosts() {
            try {
                const response = await fetch(`${API_BASE}/posts`, {
                    headers: { 'Authorization': `Bearer ${adminState.token}` }
                });
                
                if (response.ok) {
                    adminState.posts = await response.json();
                }
            } catch (error) {
                console.log('Loading local posts');
            }
            
            renderPosts();
        }
        
        function renderPosts() {
            const grid = document.getElementById('postsGrid');
            const empty = document.getElementById('postsEmpty');
            
            if (adminState.posts.length === 0) {
                grid.innerHTML = '';
                empty.style.display = 'block';
                return;
            }
            
            empty.style.display = 'none';
            grid.innerHTML = adminState.posts.map((post, index) => `
                <div class="post-card">
                    <div class="post-image" style="${post.image ? `background-image: url(${post.image}); background-size: cover;` : ''}">
                        ${!post.image ? getPostEmoji(post.type) : ''}
                    </div>
                    <div class="post-content">
                        <div class="post-title">${escapeHtml(post.title)}</div>
                        <div class="post-meta">
                            <span class="badge ${getBadgeClass(post.type)}">${post.type}</span>
                            <div class="post-actions">
                                <button class="action-btn" onclick="editPost(${index})">‚úèÔ∏è</button>
                                <button class="action-btn delete" onclick="deletePost(${index})">üóë</button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
            
            document.getElementById('statPosts').textContent = adminState.posts.length;
        }
        
        async function handleAddPost(e) {
            e.preventDefault();
            
            const post = {
                id: Date.now(),
                title: document.getElementById('postTitle').value,
                type: document.getElementById('postType').value,
                description: document.getElementById('postDescription').value,
                image: document.getElementById('postImage').value,
                createdAt: new Date().toISOString()
            };
            
            try {
                const response = await fetch(`${API_BASE}/posts`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${adminState.token}`
                    },
                    body: JSON.stringify(post)
                });
                
                if (response.ok) {
                    showToast('Post added!', '‚úÖ');
                    clearPostForm();
                    loadPosts();
                }
            } catch (error) {
                // –õ–æ–∫–∞–ª—å–Ω–æ
                adminState.posts.unshift(post);
                renderPosts();
                showToast('Post added!', '‚úÖ');
                clearPostForm();
            }
        }
        
        async function deletePost(index) {
            if (!confirm('Delete this post?')) return;
            
            try {
                const postId = adminState.posts[index].id;
                await fetch(`${API_BASE}/posts/${postId}`, {
                    method: 'DELETE',
                    headers: { 'Authorization': `Bearer ${adminState.token}` }
                });
            } catch (error) {
                adminState.posts.splice(index, 1);
            }
            
            renderPosts();
            showToast('Post deleted', '‚úÖ');
        }
        
        function clearPostForm() {
            document.getElementById('postTitle').value = '';
            document.getElementById('postType').value = 'free';
            document.getElementById('postDescription').value = '';
            document.getElementById('postImage').value = '';
        }
        
        function getPostEmoji(type) {
            switch(type) {
                case 'premium': return 'üíé';
                case 'exclusive': return 'üëë';
                default: return 'üå∏';
            }
        }
        
        function getBadgeClass(type) {
            switch(type) {
                case 'premium': return 'badge-pending';
                case 'exclusive': return 'badge-active';
                default: return '';
            }
        }
        
        // ============================================
        // SETTINGS
        // ============================================
        async function handleChangePassword(e) {
            e.preventDefault();
            
            const current = document.getElementById('currentPassword').value;
            const newPass = document.getElementById('newPassword').value;
            const confirm = document.getElementById('confirmPassword').value;
            
            if (newPass !== confirm) {
                showToast('Passwords do not match', '‚ùå', 'error');
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/password`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${adminState.token}`
                    },
                    body: JSON.stringify({ currentPassword: current, newPassword: newPass })
                });
                
                if (response.ok) {
                    showToast('Password updated!', '‚úÖ');
                    e.target.reset();
                } else {
                    const data = await response.json();
                    showToast(data.error || 'Error', '‚ùå', 'error');
                }
            } catch (error) {
                showToast('Password updated locally', '‚úÖ');
                e.target.reset();
            }
        }
        
        function resetAllData() {
            if (!confirm('This will delete ALL data. Are you absolutely sure?')) return;
            if (!confirm('Last chance! This cannot be undone!')) return;
            
            adminState.users = [];
            adminState.messages = [];
            adminState.posts = [];
            
            loadDashboard();
            showToast('All data cleared', '‚úÖ');
        }
        
        // ============================================
        // HELPERS
        // ============================================
        function formatDate(dateStr) {
            if (!dateStr) return '‚Äî';
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', {
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text || '';
            return div.innerHTML;
        }
        
        function showToast(message, icon = '‚úÖ', type = 'success') {
            const toast = document.getElementById('toast');
            document.getElementById('toastMessage').textContent = message;
            document.getElementById('toastIcon').textContent = icon;
            
            toast.className = `toast ${type}`;
            toast.classList.add('show');
            
            setTimeout(() => toast.classList.remove('show'), 3000);
        }
    </script>
</body>
</html>
